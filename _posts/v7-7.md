---
title: "V7.7 Release: A Stronger Foundation for Your Security – Unpacking Our PIN Lock Overhaul"
excerpt: "Our latest v7.7 release focuses on a critical security upgrade: a complete overhaul of the app's PIN lock system. We've tackled inconsistent activation, improved app lifecycle integration, and separated logic from state management, making your data more secure and your app experience more reliable and robust than ever before."
coverImage: "/assets/blog/post/v7-7.webp"
date: "2025-08-30T19:00:00.000Z"
author:
  name: Abdul Rafay
  picture: "/assets/blog/authors/rafay.webp"
ogImage:
  url: "/assets/blog/org/msbridge.png"
---

Hello, developers and users! Today marks the release of `v7.7`, and while we're always striving for performance and new features, this update zeroes in on something fundamental: **your security and the underlying stability of our application.** We've undertaken a significant refactor to fortify the app's PIN lock mechanism, addressing some crucial operational quirks and architectural challenges.

### The Challenge: A PIN Lock with Growing Pains

Before `v7.7`, our app's PIN lock system, designed to protect your data, had a few habits that needed correcting. Imagine closing the app, only for the PIN lock to *not* activate as expected, leaving a window of vulnerability until the app fully shut down. Not ideal for peace of mind, right?

The core issues stemmed from:

1.  **Inconsistent Activation:** The PIN lock wasn't reliably engaging upon app closure or backgrounding. It lacked proper integration with the application's lifecycle events, leading to unpredictable security states.
2.  **Entangled Logic:** All the enabling and disabling logic for the PIN toggle was deeply intertwined within our state management providers. This made it difficult to manage, test, and scale, and frankly, a bit of a headache for maintainability.
3.  **Firebase Syncing Oddities:** The PIN information was also getting caught up in Firebase synchronization, adding unnecessary complexity and potential inconsistencies for a feature that ideally should be managed locally.

We knew we could do better – for security, for reliability, and for the cleanliness of our codebase.

### The Solution: A Dedicated, Lifecycle-Aware PIN System

With `v7.7`, we're excited to announce a comprehensive overhaul that resolves these issues. We've implemented a robust, dedicated system for PIN lock management, ensuring a more predictable and secure experience.

Here's how we've achieved it:

*   **Dedicated `PinRepo`:** We've introduced a brand-new `lib/core/repo/pin_repo.dart`. This repository is now the single source of truth and handler for all PIN-related logic. Decoupling this from general user settings and state management means cleaner code, easier debugging, and a far more maintainable system.
*   **Lifecycle Integration with `PinLifecycleManager`:** To combat the inconsistent activation, we've implemented `lib/core/services/pin_lifecycle_manager.dart`. This new service ensures the PIN lock correctly observes app lifecycle events, guaranteeing that your app locks when it should – every single time. No more guessing games!
*   **Decoupling from Settings and Sync:** We've gracefully removed PIN-related logic from general user settings repositories (`user_setting_repo.dart`, `user_settings_repo.dart`) and, crucially, from Firebase synchronization services (`reverse_sync.dart`, `settings_sync_service.dart`). This streamlines the process, focusing on local, immediate security.
*   **Refactored State Management:** The `lib/core/provider/app_pin_lock_provider.dart` has undergone a significant refactor, shedding over 120 lines of complex logic by delegating responsibilities to the new `PinRepo`. This makes our state management leaner and more focused on UI-specific concerns.

The result? A PIN lock system that is not only more secure and reliable but also built on a much stronger, more organized architectural foundation.

### Under the Hood: What Changed?

For those curious about the technical specifics, here's a glimpse into the file changes that made this possible:

*   **New additions:** `lib/core/repo/pin_repo.dart` (123 lines added) and `lib/core/services/pin_lifecycle_manager.dart` (97 lines added) are the stars of the show.
*   **Major Refactoring:** `lib/core/provider/app_pin_lock_provider.dart` saw a significant shift (+231 −123), moving core logic out.
*   **Decoupling:** Large reductions in `lib/core/repo/user_setting_repo.dart` (−322) and `lib/core/services/sync/settings_sync_service.dart` (−38) highlight the successful extraction of PIN logic.
*   **UI Updates:** Changes in `lib/core/auth/app_pin_lock_wrapper.dart` and `lib/features/setting/section/user_section/pin_lock_screen.dart` ensure the user interface seamlessly integrates with the new backend.

### Beyond Security: Streamlined Operations

In addition to our security enhancements, we've also included some quality-of-life improvements for our development and build processes:

*   `e7b317a` some linux script: Enhancements to our Linux scripting for smoother operations.
*   Updated and reorganized PowerShell scripts (e.g., `CleanAndBuild.ps1` moved to `scripts/CleanAndBuild.ps1`) for cleaner and more efficient build and deployment workflows.

### Looking Forward

This `v7.7` release is a testament to our commitment to building a secure, stable, and thoughtfully engineered application. By giving our PIN lock the dedicated care it deserves, we've not only boosted your security but also paved the way for more maintainable and scalable development in the future.

We're incredibly excited for you to experience the enhanced reliability and peace of mind this update brings!

Warmly,

Abdul Rafay